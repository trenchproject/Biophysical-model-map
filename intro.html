<h3>Model description</h3>

This activity uses weather data to predict organism's body tempeartures across the US. We use <code>getGridMET</code> function from the climateR package, which obtains the most recent daily maximum and minimum temperature data available. The maximum and minimum temperatures are converted to hourly temperatures by <code>TrenchR::diurnal_temp_variation_sine</code> function, which is used as a baseline for the 2020 data. 
<br>
<br>
When a future year is selected, it adds some "anomaly" to this baseline temperatures, which is an offset value of how much warmer the air temperature is predicted to be in the future. We use the CMIP5 model - which is explained in detail below - to calculate this anomaly. We obtain the temperature data from the model for 2020, 2050, 2070 and 2090, and the temperature difference between 2020 and the year selected is used as anomaly. 
We chose to use gridMET data for 2020 instead of the CMIP5 model since gridMET data are actually measured temperatures unlike the CMIP5 model data that are predicted temperatures. We employ anomaly and add it to 2020 gridMET data instead of directly using temperature data from the model because CMIP5 model predicts surface temperatures as opposed to the gridMET measuring air temperatures, which cannot be direcly compared. 

Wind speed data are obtained from gridMET as well.

<h4>CMIP5 model</h4>
For the future weather data, it obtians monthly average surface air temperatures from the CMIP5 multimodel ensemble. This gridded projection is based on the Community Climate System Model version 4 assuming representative concentration pathway (RCP) 2.6, 6.0 and 8.5, which correspond to "Optimistic", "Intermediate" and "Pessimistic" estimates respectively.
These projections represent a greenhouse gas concentration trajectory, all of which can possibly happen in the future. The projection pathways for each scenario are depicted in the graph below. 
RCP2.6 is a stringent mitigation pathway in which radiative forcing peaks at approximately 3 W/m <sup>2</sup> before 2100 and then declines. It is characterized by substantial net negative emissions by 2100. RCP6.0 is an intermediate stabilisation pathways in which radiative forcing is stabilised at approximately 6.0 W/m <sup>2</sup> after 2100. RCP8.5 is not the most realistic projection, and is considered more as the worst-case climate change scenario. Nearly ice-free Arctic Ocean in September is likely for RCP8.5 before mid-century. 
<br>

<p align='center'>
<img src="RCP.png" width = "600px"/>
</p>

<br>
<h4>Biophysical models</h4>
We use different biophysical models for each animal, all of which are from TrenchR package.
<br>
<br>
<b>Lizards</b>: Lizard body temperatures are calculated based on <code>Tb_lizard</code> function. Lizard solar absorptivity and thermal absoptivity are set to 0.9 and 0.965, respectively. View factors between the surface of the lizard and diffuse solar radiation, reflected solar radiation, atmospheric radiation and ground thermal radation are all 0.5, assuming that the lizards are flat on the ground for simplification.
<br>
<br>
<b>Grasshoppers</b>: Grasshopper body temperatures are computed using <code>Tb_grasshopper</code> function.
Clearness index is approximated to 0.75 for a clear day, 0.5 for a partly sunny day and 0.25 for a cloudy day. 
We approximate that a quarter of the grasshopper surface area is in contact with the ground.
<br>
<br>
<b>Salamanders</b>: <code>Tb_salamander_humid</code> function is used for the calculations.
The internal skin resistance is set to 4 s/cm and boundary layer resistance to 1 s/cm.
Saturation vapor pressure of 2.5 kPa and actual vapor pressure of 2.0 kPa are used for this model.
<br>
<br>
<b>Butterflies</b>: For butterflies, we use <code>Tb_butterfly</code> function.
Surface temperature in the shade is assumed to be 5 °C cooler than the air temperature. Diffuse solar radiation flux is assumed to be half of the direct solar radiation flux regardless of the weather.
<br>
<br>
<b>Snails</b>: Snails body temperatures are obtained from <code>Tb_snail</code> function.
Fraction of the sky covered by the cloud is approximated to 0 on a clear day, 0.5 on a partly sunny day and 1 on a cloudy day. Snails water loss rate is ignored for this model. GridMET has no information on the wind sensor height, and therefore is set to 1 m above ground for this model.
<br>
<br>
<b>Mussels</b>: <code>Tb_mussel</code> function is used to calculate mussel body temperatures.
Diffuse fraction, which is the proportion of solar radiation that is diffuse, is defined as 0.1 on a clear day, 0.5 on a partly sunny day and 1 on a cloudy day. When gaping, we assume constant mass loss rate of 5% of initial body mass per hour. 
<br>
<br>
<b>Other data</b>: Elevation data are obtained from NOAA ETOPO1 Global Relief Model, grid-registered ETOPO1 Ice Surface.
Zenith angle was calculated using <code>TrenchR::zenith_angle</code> function for each point on the map by the longitude, latitude and the day of the year.
For any functions that require ground temperatures, they are assumed to be 5 °C warmer than the air temperatures.
Surface albedo is set to be 0.25 for grass, 0.1 for dark soil and 0.75 for snow surface as listed in Campbell & Norman (1997).
Radiation is estimated as 900 W/m <sup>2</sup>, 500 W/m <sup>2</sup> and 200 W/m <sup>2</sup> for a clear day, a partly sunny day and a cloudy day respectively. <br>